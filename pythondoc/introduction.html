

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>1. Introduction &mdash; gsindl v1.4 documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="gsindl v1.4 documentation" href="index.html" />
    <link rel="next" title="2. slcs – utility functions for assisting with responses from SLCS servers" href="ref/slcs.html" />
    <link rel="prev" title="Welcome to gsindl’s documentation!" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="ref/slcs.html" title="2. slcs – utility functions for assisting with responses from SLCS servers"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to gsindl’s documentation!"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">gsindl v1.4 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="introduction">
<h1>1. Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<p>This library provides some utility classes and functions for deailing with X509 certificates. Most of the tasks performed by these classes are trivial but they require use of the M2Crypto classes which can be a pain. The problem isn&#8217;t that the M2Crypto classes are complex, it just that when doing GSI tasks i find myself repeating work in different projects.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gsindl.certificate</span> <span class="kn">import</span> <span class="n">generate_request</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">generate_request</span><span class="p">(</span><span class="s">&quot;DC=au,DC=org,DC=arcs,DC=test,O=VPAC,CN=Russell Sim&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="s">&#39;sha1&#39;</span><span class="p">)</span>
<span class="go">256</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">r</span><span class="o">.</span><span class="n">as_text</span><span class="p">()</span>
<span class="go">Certificate Request:</span>
<span class="go">    Data:</span>
<span class="go">        Version: 0 (0x0)</span>
<span class="go">        Subject: DC=au, DC=org, DC=arcs, DC=test, O=VPAC, CN=Russell Sim</span>
<span class="go">        Subject Public Key Info:</span>
<span class="go">            Public Key Algorithm: rsaEncryption</span>
<span class="go">            RSA Public Key: (2048 bit)</span>
<span class="go">                Modulus (2048 bit):</span>
<span class="go">                    ...</span>
<span class="go">                Exponent: 65537 (0x10001)</span>
<span class="go">        Attributes:</span>
<span class="go">            a0:00</span>
<span class="go">    Signature Algorithm: sha1WithRSAEncryption</span>
<span class="go">        ...</span>
<span class="go">&lt;BLANKLINE&gt;</span>
</pre></div>
</div>
<p>Private Key</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gsindl.key</span> <span class="kn">import</span> <span class="n">key_to_str</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">key_to_str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="go">-----BEGIN PRIVATE KEY-----</span>
<span class="gp">...</span>
<span class="go">-----END PRIVATE KEY-----</span>
</pre></div>
</div>
<p>Generating a request with a 1024 bit key for compatablity with older applications.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">generate_request</span><span class="p">(</span><span class="n">dn</span><span class="o">=</span><span class="s">&quot;DC=au,DC=org,DC=arcs,DC=test,O=VPAC,CN=Russell Sim&quot;</span><span class="p">,</span> <span class="n">keySize</span><span class="o">=</span><span class="mi">1024</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="s">&#39;sha1&#39;</span><span class="p">)</span>
<span class="go">128</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">r</span><span class="o">.</span><span class="n">as_text</span><span class="p">()</span>
<span class="go">Certificate Request:</span>
<span class="go">    Data:</span>
<span class="go">        Version: 0 (0x0)</span>
<span class="go">        Subject: DC=au, DC=org, DC=arcs, DC=test, O=VPAC, CN=Russell Sim</span>
<span class="go">        Subject Public Key Info:</span>
<span class="go">            Public Key Algorithm: rsaEncryption</span>
<span class="go">            RSA Public Key: (1024 bit)</span>
<span class="go">                Modulus (1024 bit):</span>
<span class="go">                    ...</span>
<span class="go">                Exponent: 65537 (0x10001)</span>
<span class="go">        Attributes:</span>
<span class="go">            a0:00</span>
<span class="go">    Signature Algorithm: sha1WithRSAEncryption</span>
<span class="go">        ...</span>
<span class="go">&lt;BLANKLINE&gt;</span>
</pre></div>
</div>
<p>It&#8217;s easier to access a certificate without needing to introspect M2Crypto to figure out the calls.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">r</span><span class="o">.</span><span class="n">as_pem</span><span class="p">()</span>
<span class="go">-----BEGIN CERTIFICATE REQUEST-----</span>
<span class="gp">...</span>
<span class="go">-----END CERTIFICATE REQUEST-----</span>
<span class="go">&lt;BLANKLINE&gt;</span>
</pre></div>
</div>
<p>Extensions are passed in as a list of dictionarys.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">extensions</span> <span class="o">=</span> <span class="p">[{</span><span class="s">&#39;critical&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span> <span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="s">&#39;ExtendedKeyUsage&#39;</span><span class="p">,</span> <span class="s">&#39;value&#39;</span><span class="p">:</span> <span class="s">&#39;clientAuth&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s">&#39;critical&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="s">&#39;KeyUsage&#39;</span><span class="p">,</span> <span class="s">&#39;value&#39;</span><span class="p">:</span> <span class="s">&#39;Digital Signature, Key Encipherment&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s">&#39;critical&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span> <span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="s">&#39;CertificatePolicies&#39;</span><span class="p">,</span> <span class="s">&#39;value&#39;</span><span class="p">:</span> <span class="s">&#39;1.3.6.1.4.1.31863.1.0.1&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s">&#39;critical&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span> <span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="s">&#39;SubjectAltName&#39;</span><span class="p">,</span> <span class="s">&#39;value&#39;</span><span class="p">:</span> <span class="s">&#39;email:russell@vpac.org&#39;</span><span class="p">}]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">generate_request</span><span class="p">(</span><span class="n">dn</span><span class="o">=</span><span class="s">&quot;DC=au,DC=org,DC=arcs,DC=test,O=VPAC,CN=Russell Sim&quot;</span><span class="p">,</span> <span class="n">keySize</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="n">extensions</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="s">&#39;sha1&#39;</span><span class="p">)</span>
<span class="go">128</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">r</span><span class="o">.</span><span class="n">as_text</span><span class="p">()</span>
<span class="go">Certificate Request:</span>
<span class="go">    Data:</span>
<span class="go">        Version: 0 (0x0)</span>
<span class="go">        Subject: DC=au, DC=org, DC=arcs, DC=test, O=VPAC, CN=Russell Sim</span>
<span class="go">        Subject Public Key Info:</span>
<span class="go">            Public Key Algorithm: rsaEncryption</span>
<span class="go">            RSA Public Key: (1024 bit)</span>
<span class="go">                Modulus (1024 bit):</span>
<span class="go">                ...</span>
<span class="go">                Exponent: 65537 (0x10001)</span>
<span class="go">        Attributes:</span>
<span class="go">        Requested Extensions:</span>
<span class="go">            X509v3 Extended Key Usage:</span>
<span class="go">                TLS Web Client Authentication</span>
<span class="go">            X509v3 Key Usage: critical</span>
<span class="go">                Digital Signature, Key Encipherment</span>
<span class="go">            X509v3 Certificate Policies:</span>
<span class="go">                Policy: 1.3.6.1.4.1.31863.1.0.1</span>
<span class="go">&lt;BLANKLINE&gt;</span>
<span class="go">            X509v3 Subject Alternative Name:</span>
<span class="go">                email:russell@vpac.org</span>
<span class="go">    Signature Algorithm: sha1WithRSAEncryption</span>
<span class="go">    ...</span>
<span class="go">&lt;BLANKLINE&gt;</span>
</pre></div>
</div>
<div class="section" id="creating-certificates">
<h2>1.1. Creating certificates<a class="headerlink" href="#creating-certificates" title="Permalink to this headline">¶</a></h2>
<p>Creating a certificate, currently this can&#8217;t be done from a request because there are no methods to extract the extensions from a request.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gsindl.certificate</span> <span class="kn">import</span> <span class="n">generate_certificate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extensions</span> <span class="o">=</span> <span class="p">[{</span><span class="s">&#39;critical&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span> <span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="s">&#39;ExtendedKeyUsage&#39;</span><span class="p">,</span> <span class="s">&#39;value&#39;</span><span class="p">:</span> <span class="s">&#39;clientAuth&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s">&#39;critical&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="s">&#39;KeyUsage&#39;</span><span class="p">,</span> <span class="s">&#39;value&#39;</span><span class="p">:</span> <span class="s">&#39;Digital Signature, Key Encipherment&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s">&#39;critical&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span> <span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="s">&#39;CertificatePolicies&#39;</span><span class="p">,</span> <span class="s">&#39;value&#39;</span><span class="p">:</span> <span class="s">&#39;1.3.6.1.4.1.31863.1.0.1&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s">&#39;critical&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span> <span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="s">&#39;SubjectAltName&#39;</span><span class="p">,</span> <span class="s">&#39;value&#39;</span><span class="p">:</span> <span class="s">&#39;email:russell@vpac.org&#39;</span><span class="p">}]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">generate_certificate</span><span class="p">(</span><span class="s">&quot;DC=au,DC=org,DC=arcs,DC=test,O=VPAC,CN=Russell Sim&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="n">extensions</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">set_issuer_name</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">get_subject</span><span class="p">())</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="s">&#39;sha1&#39;</span><span class="p">)</span>
<span class="go">256</span>
</pre></div>
</div>
</div>
<div class="section" id="creating-a-proxy-certificate">
<h2>1.2. Creating a proxy certificate<a class="headerlink" href="#creating-a-proxy-certificate" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gsindl.proxy</span> <span class="kn">import</span> <span class="n">generate_proxy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">generate_proxy</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="s">&#39;sha1&#39;</span><span class="p">)</span>
<span class="go">256</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">p</span><span class="o">.</span><span class="n">as_text</span><span class="p">()</span>
<span class="go">Certificate:</span>
<span class="go">    Data:</span>
<span class="go">        Version: 3 (0x2)</span>
<span class="go">        Serial Number: ... (0x...)</span>
<span class="go">        Signature Algorithm: sha1WithRSAEncryption</span>
<span class="go">        Issuer: DC=au, DC=org, DC=arcs, DC=test, O=VPAC, CN=Russell Sim</span>
<span class="go">        Validity</span>
<span class="go">            Not Before: ...</span>
<span class="go">            Not After : ...</span>
<span class="go">        Subject: DC=au, DC=org, DC=arcs, DC=test, O=VPAC, CN=Russell Sim, CN=...</span>
<span class="go">        Subject Public Key Info:</span>
<span class="go">            Public Key Algorithm: rsaEncryption</span>
<span class="go">            RSA Public Key: (2048 bit)</span>
<span class="go">                Modulus (2048 bit):</span>
<span class="go">                ...</span>
<span class="go">                Exponent: 65537 (0x10001)</span>
<span class="go">        X509v3 extensions:</span>
<span class="go">            X509v3 Key Usage: critical</span>
<span class="go">                Digital Signature, Key Encipherment</span>
<span class="go">            Proxy Certificate Information: critical</span>
<span class="go">                Path Length Constraint: infinite</span>
<span class="go">                Policy Language: Inherit all</span>
<span class="go">&lt;BLANKLINE&gt;</span>
<span class="go">    Signature Algorithm: sha1WithRSAEncryption</span>
<span class="go">        ...</span>
<span class="go">&lt;BLANKLINE&gt;</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">1. Introduction</a><ul>
<li><a class="reference internal" href="#creating-certificates">1.1. Creating certificates</a></li>
<li><a class="reference internal" href="#creating-a-proxy-certificate">1.2. Creating a proxy certificate</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Welcome to gsindl&#8217;s documentation!</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="ref/slcs.html"
                        title="next chapter">2. <tt class="docutils literal"><span class="pre">slcs</span></tt> &#8211; utility functions for assisting with responses from SLCS servers</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/introduction.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="ref/slcs.html" title="2. slcs – utility functions for assisting with responses from SLCS servers"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to gsindl’s documentation!"
             >previous</a> |</li>
        <li><a href="index.html">gsindl v1.4 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2009, Russell Sim, Sam Morrison.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
  </body>
</html>